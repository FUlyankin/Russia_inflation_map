Aexam=c(
5.4,3.4,1.7,0.2,
5.1,3.7,1.5,0.4,
4.6,3.6,1.0,0.2,
5.1,3.3,1.7,0.5,
4.8,3.4,1.9,0.2,
5.0,3.0,1.6,0.2,
5.0,3.4,1.6,0.4,
5.2,3.5,1.5,0.2,
5.2,3.4,1.4,0.2,
4.7,3.2,1.6,0.2,
4.8,3.1,1.6,0.2,
5.4,3.4,1.5,0.4,
5.2,4.1,1.5,0.1,
5.5,4.2,1.4,0.2,
4.9,3.1,1.5,0.2,
5.0,3.2,1.2,0.2,
5.5,3.5,1.3,0.2,
4.9,3.6,1.4,0.1,
4.4,3.0,1.3,0.2,
5.1,3.4,1.5,0.2,
5.0,3.5,1.3,0.3,
4.5,2.3,1.3,0.3,
4.4,3.2,1.3,0.2,
5.0,3.5,1.6,0.6,
5.1,3.8,1.9,0.4,
4.8,3.0,1.4,0.3,
5.1,3.8,1.6,0.2,
4.6,3.2,1.4,0.2,
5.3,3.7,1.5,0.2,
5.0,3.3,1.4,0.2)
Blearn=c(
7.0,3.2,4.7,1.4,
6.4,3.2,4.5,1.5,
6.9,3.1,4.9,1.5,
5.5,2.3,4.0,1.3,
6.5,2.8,4.6,1.5,
5.7,2.8,4.5,1.3,
6.3,3.3,4.7,1.6,
4.9,2.4,3.3,1.0,
6.6,2.9,4.6,1.3,
5.2,2.7,3.9,1.4,
5.0,2.0,3.5,1.0,
5.9,3.0,4.2,1.5,
6.0,2.2,4.0,1.0,
6.1,2.9,4.7,1.4,
5.6,2.9,3.6,1.3,
6.7,3.1,4.4,1.4,
5.6,3.0,4.5,1.5,
5.8,2.7,4.1,1.0,
6.2,2.2,4.5,1.5,
5.6,2.5,3.9,1.1)
Bexam=c(
5.9,3.2,4.8,1.8,
6.1,2.8,4.0,1.3,
6.3,2.5,4.9,1.5,
6.1,2.8,4.7,1.2,
6.4,2.9,4.3,1.3,
6.6,3.0,4.4,1.4,
6.8,2.8,4.8,1.4,
6.7,3.0,5.0,1.7,
6.0,2.9,4.5,1.5,
5.7,2.6,3.5,1.0,
5.5,2.4,3.8,1.1,
5.5,2.4,3.7,1.0,
5.8,2.7,3.9,1.2,
6.0,2.7,5.1,1.6,
5.4,3.0,4.5,1.5,
6.0,3.4,4.5,1.6,
6.7,3.1,4.7,1.5,
6.3,2.3,4.4,1.3,
5.6,3.0,4.1,1.3,
5.5,2.5,4.0,1.3,
5.5,2.6,4.4,1.2,
6.1,3.0,4.6,1.4,
5.8,2.6,4.0,1.2,
5.0,2.3,3.3,1.0,
5.6,2.7,4.2,1.3,
5.7,3.0,4.2,1.2,
5.7,2.9,4.2,1.3,
6.2,2.9,4.3,1.3,
5.1,2.5,3.0,1.1,
5.7,2.8,4.1,1.3)
Clearn=c(
6.3,3.3,6.0,2.5,
5.8,2.7,5.1,1.9,
7.1,3.0,5.9,2.1,
6.3,2.9,5.6,1.8,
6.5,3.0,5.8,2.2,
7.6,3.0,6.6,2.1,
4.9,2.5,4.5,1.7,
7.3,2.9,6.3,1.8,
6.7,2.5,5.8,1.8,
7.2,3.6,6.1,2.5,
6.5,3.2,5.1,2.0,
6.4,2.7,5.3,1.9,
6.8,3.0,5.5,2.1,
5.7,2.5,5.0,2.0,
5.8,2.8,5.1,2.4,
6.4,3.2,5.3,2.3,
6.5,3.0,5.5,1.8,
7.7,3.8,6.7,2.2,
7.7,2.6,6.9,2.3,
6.0,2.2,5.0,1.5)
Cexam=c(
6.9,3.2,5.7,2.3,
5.6,2.8,4.9,2.0,
7.7,2.8,6.7,2.0,
6.3,2.7,4.9,1.8,
6.7,3.3,5.7,2.1,
7.2,3.2,6.0,1.8,
6.2,2.8,4.8,1.8,
6.1,3.0,4.9,1.8,
6.4,2.8,5.6,2.1,
7.2,3.0,5.8,1.6,
7.4,2.8,6.1,1.9,
7.9,3.8,6.4,2.0,
6.4,2.8,5.6,2.2,
6.3,2.8,5.1,1.5,
6.1,2.6,5.6,1.4,
7.7,3.0,6.1,2.3,
6.3,3.4,5.6,2.4,
6.4,3.1,5.5,1.8,
6.0,3.0,4.8,1.8,
6.9,3.1,5.4,2.1,
6.7,3.1,5.6,2.4,
6.9,3.1,5.1,2.3,
5.8,2.7,5.1,1.9,
6.8,3.2,5.9,2.3,
6.7,3.3,5.7,2.5,
6.7,3.0,5.2,2.3,
6.3,2.5,5.0,1.9,
6.5,3.0,5.2,2.0,
6.2,3.4,5.4,2.3,
5.9,3.0,5.1,1.8)
Alearn = t(matrix(Alearn, nrow = 4))
Aexam = t(matrix(Aexam, nrow = 4))
Blearn = t(matrix(Blearn, nrow = 4))
Bexam = t(matrix(Bexam, nrow = 4))
Clearn = t(matrix(Clearn, nrow = 4))
Cexam = t(matrix(Cexam, nrow = 4))
# функция для прогнозирования
predictor <- function(w,X){
return(X%*%w > 0)
}
# функция для вычисления градиента
grad <- function(w,X,y){
return(1/nrow(X)*t(t(sign(X%*%w) - y)%*%X))
}
# функция для обучения вектора весов
fitmodel <- function(X, y, n_iter){
w = c(1,1,1,1,1)
wt = w
wtt = wt - 1*grad(wt,X,y)
for(i in 1:n_iter){
wt = wtt
wtt = wt - 1* grad(wt,X,y)
print(wtt)
}
return(wtt)
}
# выборка номер один
y = c(rep(1,20),rep(0,20))
X = cbind(rep(1,40),rbind(Alearn, Blearn))
# учим первую модель и смотрим на число ошибок
w1 <- fitmodel(X, y, 1000)
w1
# смотрим число ошибок
sum(predictor(w1, cbind(rep(1,20),Alearn)) == FALSE) + sum(predictor(w1, cbind(rep(1,20),Blearn)) == TRUE)
sum(predictor(w1, cbind(rep(1,30),Aexam)) == FALSE) + sum(predictor(w1, cbind(rep(1,30),Bexam)) == TRUE)
X
X = rbind(Alearn, Blearn)
y = c(rep(1,20),rep(0,20))
X = rbind(Alearn, Blearn)
y = c(rep(1,20),rep(0,20))
X = rbind(Alearn, Blearn)
X
colMeans(X)
X > colMeans(X)
1*(X > colMeans(X))
XXX = 1*(X > colMeans(X))
X_train = 1*(X > colMeans(X))
# найдём P(text | spam)*P(spam)
freq =
colSums(X_train[y == 1])
X_train
X_train = 1*(X > colMeans(X))
# найдём P(text | spam)*P(spam)
freq =
colSums(X_train[y == 1])
y == 1
X_train[y == 1]
# найдём P(text | spam)*P(spam)
freq =
colSums(X_train[, y == 1])
X_train[, y == 1]
X_train[,y == 1]
# найдём P(text | spam)*P(spam)
freq =
colSums(X_train[1:20])
X_train[1:20]
X_train
X_train[1:20,]
# найдём P(text | spam)*P(spam)
freq =
colSums(X_train[1:20,])
colSums(X_train[1:20,])
mn = colMeans(X)
mn
XX = rbind(Aexam, Bexam)
X_test = 1*(XX > mn)
X_test
freq_A
freq_A
# найдём P(x | y)*P(y)
freq_A = colMeans(X_train[1:20,])*p
freq_B = colMeans(X_train[21:40,])*p
p = 0.5 # априорная вероятность класса
mn = colMeans(X)
X_train = 1*(X > mn)
X_test = 1*(XX > mn)
# найдём P(x | y)*P(y)
freq_A = colMeans(X_train[1:20,])*p
freq_B = colMeans(X_train[21:40,])*p
freq_A*X_test
prod(freq_A*X_test)
freq_A*X_test
A = freq_A*X_test
B = freq_B*X_test
for(i in 1: nrow(X_test)){
y1 = prod()
}
# сделаем прогнозы для тестовой выборки
forecasts = c()
A = freq_A*X_test
B = freq_B*X_test
for(i in 1: nrow(X_test)){
y1 = prod(A[i])
y2 = prod(B[i])
if(y1 > y2){
forecasts = append(forecasts,1)
}else{
forecasts = append(forecasts,0)
}
}
forecasts
forecast[1:30]
forecasts[1:30]
forecasts[1:30] == 1
forecasts[1:30] == 0
sum(forecasts[1:30] == 0) + sum(forecasts[31:60] == 0)
(sum(forecasts[1:30] == 0) + sum(forecasts[31:60] == 0))/60*100
x <- seq(0,2,0.1)
x
y <- c(-0.3362, 1.806, 2.8101, 0.6112, 2.2959, 2.8481, 0.1808, 0.5416, 2.793, 2.0963, 3.5, 3.9834, 4.2866, 5.3261, 5.2257, 6.3355, 4.6026, 6.5253, 7.2156, 6.6904, 9.5773)
y
x
y + x
length(x)
length(y)
t(x)%*%x
solve(t(x)%*%x + lambda)
lambda = 2
solve(t(x)%*%x + lambda)
x%*%solve(t(x)%*%x + lambda)
x%*%solve(t(x)%*%x + lambda)%*%t(x)
x%*%solve(t(x)%*%x + lambda)%*%t(x)%*%y
H = x%*%solve(t(x)%*%x + lambda)%*%t(x)
H
H = x%*%solve(t(x)%*%x + lambda)%*%t(x)
H
diag(H)
h = diag(H)
t = H%*%y
y - t
(y - t)/(1 - h)
((y - t)/(1 - h))^2
mean(((y - t)/(1 - h))^2)
x
cbind(x,x^2)
cbind(1,x,x^2)
cbind(1, x, x^2, x^3, x^4, x^5)
matrix(0,21,21)
I = matrix(0,21,21)
diag(I) = 1
I
H = X%*%solve(t(X)%*%X + lambda*I)%*%t(X)
X <- cbind(1, x, x^2, x^3, x^4, x^5)
I = matrix(0,21,21)
diag(I) = 1
H = X%*%solve(t(X)%*%X + lambda*I)%*%t(X)
I
I = matrix(0,21,21)
diag(I) = lambda
H = X%*%solve(t(X)%*%X + I)%*%t(X)
t(X)%*%X
X <- cbind(1, x, x^2, x^3, x^4, x^5)
I = matrix(0,6,6)
diag(I) = lambda
H = X%*%solve(t(X)%*%X + I)%*%t(X)
H
h = diag(H)
h
t = H%*%y
t
rss = mean(((y - t)/(1 - h))^2)
rss
rss <- rep(0,21)
lambda = 0
for(i in 1:22){
rss[i] = lambda_evaluate(lambda + 0.1*(i-1))
}
lambda_evaluate <- function(lambda){
I = matrix(0,6,6)
diag(I) = lambda
H = X%*%solve(t(X)%*%X + I)%*%t(X)
h = diag(H)
t = H%*%y
rss = mean(((y - t)/(1 - h))^2)
return(rss)
}
rss <- rep(0,21)
lambda = 0
for(i in 1:22){
rss[i] = lambda_evaluate(lambda + 0.1*(i-1))
}
rss
library(ggplot2)
lambda <- seq(0,2,0.1)
length(lambda)
length(rss)
rss <- rep(0,20)
length(rss)
rss <- rep(0,21)
lambda <- seq(0,2,0.1)
rss <- rep(0,21)
lambda <- seq(0,2,0.1)
for(i in 1:21){
rss[i] = lambda_evaluate(lambda[i])
}
rss
qplot(lambda, rss, geom='line')
lambda <- seq(0,10,0.1)
length(lambda)
rss <- rep(0,101)
lambda <- seq(0,10,0.1)
for(i in 1:21){
rss[i] = lambda_evaluate(lambda[i])
}
qplot(lambda, rss, geom='line')
lambda
rss
for(i in 1:101){
rss[i] = lambda_evaluate(lambda[i])
}
qplot(lambda, rss, geom='line')
rss <- rep(1,101)
lambda <- seq(0.1,10,0.1)
for(i in 1:101){
rss[i] = lambda_evaluate(lambda[i])
}
qplot(lambda, rss, geom='line')
length(lambda)
rss <- rep(1,100)
lambda <- seq(0.1,10,0.1)
for(i in 1:101){
rss[i] = lambda_evaluate(lambda[i])
}
qplot(lambda, rss, geom='line')
for(i in 1:100){
rss[i] = lambda_evaluate(lambda[i])
}
qplot(lambda, rss, geom='line')
length(rss)
rss <- rep(1,100)
lambda <- seq(0.1,10,0.1)
for(i in 1:100){
rss[i] = lambda_evaluate(lambda[i])
}
qplot(lambda, rss, geom='line')
which.min(rss)
lambda[which.min(rss)]
lamba <- c(0,2,4,6,8,10)
predict <- function(lambda){
I = matrix(0,6,6)
diag(I) = lambda
H = X%*%solve(t(X)%*%X + I)%*%t(X)
t = H%*%y
return(t)
}
t(1)
predict(1)
predict(lambda)
predict(lamba)
lamba <- c(0,2,4,6,8,10)
predict(lamba)
data.frame(x, 'l0' = predict(0), 'l2' = predict(2),
'l4' = predict(0), 'l6' = predict(2),
'l8' = predict(0), 'l10' = predict(2))
ggplot(df) +
geom_line(x,'l0')
?ggplot
ggplot(df, aes(x)) +
geom_line(x,'l0')
ggplot(df) +
geom_line(aes(x, 'l0'))
ggplot(df) +
geom_line(aes(x, 'l0'))
ggplot(mdf) +
geom_line(aes(x='x', y='l0'))
ggplot(df) +
geom_line(aes(x='x', y='l0'))
ggplot(df) + geom_line(aes(x='x', y='l0'))
df
df = data.frame(x, 'l0' = predict(0), 'l2' = predict(2),
'l4' = predict(0), 'l6' = predict(2),
'l8' = predict(0), 'l10' = predict(2))
df
ggplot(df) + geom_line(aes(x='x', y='l0'))
df = data.frame('x' = x, 'l0' = predict(0), 'l2' = predict(2),
'l4' = predict(0), 'l6' = predict(2),
'l8' = predict(0), 'l10' = predict(2))
ggplot(df) +
geom_line(aes(x='x', y='l0'))
ggplot(df) +
geom_line(aes(x='x', y='l10'))
y
df
df = data.frame('x' = x, 'l0' = predict(0), 'l2' = predict(2),
'l4' = predict(4), 'l6' = predict(6),
'l8' = predict(8), 'l10' = predict(10))
ggplot(df, aes(x='x', y=value)) +
geom_line( )
ggplot(df, aes(x='x')) +
geom_line( )
ggplot(df, aes(x='x')) +
geom_line(aes(y='l10') )
df
df$l10
plot(x,predict(0))
plot(x,predict(0), type = 'line')
plot(x,predict(0), type = 'line', color='red')
?plot
plot(x,predict(0), type = 'line')
plot(x,predict(0), type = 'line')
plot(x,predict(2), type = 'line')
plot(x,predict(0), type = 'line')
abline(plot(x,predict(2), type = 'line') )
qplot(x,predict(0), type = 'line')
qplot(x,predict(2), type = 'line')
qplot(x,predict(0), geom = 'line')
qplot(x,predict(2), geom = 'line')
ggplot(df, aes('x')) +
geom_line(aes(y = 'l0', colour = "var0")) +
geom_line(aes(y = 'l2', colour = "var1"))
df = data.frame('x' = x, 'l0' = predict(0), 'l2' = predict(2),
'l4' = predict(4), 'l6' = predict(6),
'l8' = predict(8), 'l10' = predict(10))
ggplot(df, aes('x')) +
geom_line(aes(y = 'l0', colour = "var0")) +
geom_line(aes(y = 'l2', colour = "var1"))
ggplot(df, aes('x')) +
geom_line(aes(y = l0, colour = "l0")) +
geom_line(aes(y = l2, colour = "l1"))
df
ggplot(df, aes('x')) +
geom_line(aes(y = df$'l0', colour = "l0")) +
geom_line(aes(y = df$'l2', colour = "l1"))
df$'l0'
ggplot(df, aes(x = x)) +
geom_line(aes(y = df$'l0', colour = "l0")) +
geom_line(aes(y = df$'l2', colour = "l1"))
ggplot(df, aes(x = x)) +
geom_line(aes(y = df$'l0', colour = "l0")) +
geom_line(aes(y = df$'l2', colour = "l2")) +
geom_line(aes(y = df$'l4', colour = "l4")) +
geom_line(aes(y = df$'l6', colour = "l6")) +
geom_line(aes(y = df$'l8', colour = "l8")) +
geom_line(aes(y = df$'l10', colour = "l10"))
library(ggplot2)
X <- cbind(1, x, x^2, x^3, x^4, x^5)
lambda_evaluate <- function(lambda){
I = matrix(0,6,6)
diag(I) = lambda
H = X%*%solve(t(X)%*%X + I)%*%t(X)
h = diag(H)
t = H%*%y
rss = mean(((y - t)/(1 - h))^2)
return(rss)
}
rss <- rep(1,100)
lambda <- seq(0.1,10,0.1)
for(i in 1:100){
rss[i] = lambda_evaluate(lambda[i])
}
lambda[which.min(rss)]
qplot(lambda, rss, geom='line')
library(rsconnect)
rsconnect::setAccountInfo(name='russiamotherland1',
token='92FC674D11B110DC86C48BE8EAD3D1E2',
secret='<SECRET>')
rsconnect::setAccountInfo(name='russiamotherland1',
token='92FC674D11B110DC86C48BE8EAD3D1E2',
secret='YTy+u31hqRsVP30DDbGvk8XT9beLHn5Bfgk66ZkD')
pwd
setwd("~/Documents/Russia_inflation_map/russia_price_map")
deployApp()
rsconnect::setAccountInfo(name='russiamotherland1',
token='92FC674D11B110DC86C48BE8EAD3D1E2',
secret='YTy+u31hqRsVP30DDbGvk8XT9beLHn5Bfgk66ZkD')
deployApp()
shiny::runApp()
