for(j in 1:(101-30)){
y_test <- y[j:101]
test_result <- adf.test(y_test,alternative = 'explosive')
current_adf[j] <- test_result$statistic
}
pre_sup_adf <- rep(0,101-30)
for(j in 1:(101-30)){
y_test <- y[j:101]
test_result <- adf.test(y_test,alternative = 'explosive')
pre_sup_adf[j] <- test_result$statistic
}
pre_sup_adf
max(pre_sup_adf)
data <- read.table("data.dat", header=TRUE);
nreg <- NCOL(data); #Number of regions
data <- read.table("data.dat", header=TRUE);
data
df
P_final
NCOL(P_final)
data <- P_final
wmin <-37;  #Change it if necessary!
total_gsadf <- matrix(nrow=1, ncol=nreg);
unroot_data=function(x,lag){
if(lag==0){
x_embed=embed(x,2);
return(cbind(x_embed[,1],1,x_embed[,2]));
}else{
x_embed=embed(x,lag+2);
dx_embed=embed(diff(x),lag+1)[,-1];
x_lev=x_embed[,1]; # the level of the series
x_lag=x_embed[,2]; # the lag of the series
dat=cbind(x_lev,1,x_lag,dx_embed);
return(dat);
}
}
rls.phillipsgsadf <- function(yxmat,wmin){
# wmin - minimum window size
# yxmat[,1] dependent variables
# yxmat[,-1]  covariates - including the intercept in the first column
ny <- NROW(yxmat); #Sample size
w <- wmin;
nr <-  ny-w+1;
x <- as.matrix(yxmat[,-1]);
y <- as.matrix(yxmat[,1]);
numcol <- NCOL(x);
####Create matrices to store SADF, BSADF####
tstat <- matrix(data=-99,nrow=ny,ncol=nr);
sadf <- matrix(,nrow=nr,ncol=1);
bsadf <- matrix(,nrow=nr, ncol=ny);
bsadft <- matrix(,nrow=ny, ncol=1);
####Run the Loop####
for(i in 1:nr){
w <- wmin;
sxx <- x[i:(w+i-1),];
sym <- y[i:(w+i-1),];
sy <- as.matrix(sym);
sx <-as.matrix(sxx);
tsx <- t(sx);
g <- qr.solve(tsx%*%sx);
b <- as.matrix(g%*%tsx%*%sy);
res <- sy-sx%*%b;
sqres <- sum(res^2) ;
vares <- sqres/(w-numcol);
sbb <- sqrt(vares*diag(g));
sb <- as.matrix(sbb);
tstat[w+i-1,i] <- (b[2,1]-1)/sb[2,1];
w <- w+1;
while((w+i-1)<(ny+1)) {
sxx <- x[i:(w+i-1),];
sym <- y[i:(w+i-1),];
sy <- as.matrix(sym);
sx <-as.matrix(sxx);
tsxn <- as.matrix(x[w+i-1,]);
syn <- as.matrix(y[w+i-1,]);
sxn <- t(tsxn);
kaka<-  as.vector( (1+sxn%*%g%*%tsxn)^(-1) , "numeric");
g <- g - kaka*(g%*%tsxn)%*%(sxn%*%g);
b <- b-g%*%tsxn%*%(sxn%*%b-syn);
res <- sy-sx%*%b;
sqres <- sum(res^2) ;
vares <- sqres/(w-numcol);
sbb <- sqrt(vares*diag(g));
sb <- as.matrix(sbb);
tstat[w+i-1,i] <- (b[2,1]-1)/sb[2,1];
w <- w+1;
}
sadf[i,1] <- max(tstat[,i]);
auxvec <- t(tstat[,i]);
bsadf[i,] <- auxvec;
}
gsadf<-max(sadf);
for(p in 1:ny){
bsadft[p,1] <- max(bsadf[,p]);
}
return(bsadft);
}
total_bsadf <- matrix(nrow=ny,ncol=nreg);
rls.phillipsgsadf(P_final,0.100)
rls.phillipsgsadf(P_final,0.1)
rls.phillipsgsadf(P_final,1)
rls.phillipsgsadf(P_final,10)
dif_maker <- function(y){
output <- c( )
for(i in 2:length(y)){
output[i] <- y[i] - y[i-1]
}
return(output[-1])
}
matrix_maker <- function(y,p){
n <- length(y)
output <- matrix(NA,ncol=p,nrow=(n-p+1))
for(lag in 1:p){
output[,lag] <- y[lag:(n-p+lag)]
}
return(output)
}
y_test <- P_final
y_diff <- dif_maker(y_test)
pre_ddy <- matrix_maker(y_diff,5) # Первый столбец - объясняемая, остальное - объясняющие
dy <- pre_ddy[,1]
ddy <- pre_ddy[,-1]
lag_y <- y_test[1:(length(y_test)-5)]
data = data.frame('dy'=dy,'dy1' = ddy[,1],'dy2' = ddy[,2],'dy3' = ddy[,3],'dy4' = ddy[,4],
'lag_y' = lag_y)
data
data$dy
length(data$dy)
constant <- rep(1,length(data$dy))
data = data.frame('const' = constant,'dy'=dy,'dy1' = ddy[,1],'dy2' = ddy[,2],'dy3' = ddy[,3],'dy4' = ddy[,4],
'lag_y' = lag_y)
data
rls.phillipsgsadf(data,1)
rls.phillipsgsadf(data,0.1)
rls.phillipsgsadf(data,10)
rls.phillipsgsadf(data,30)
rls.phillipsgsadf(data,50)
rls.phillipsgsadf(data,5)
rls.phillipsgsadf(data,7)
for(region in 1:nreg){
y=data[,region];
yxmat= unroot_data(y,0); #Change the number of lags if necessary
ny=NROW(yxmat);
bsadf=rls.phillipsgsadf(yxmat,wmin);
bsadft=as.matrix(bsadf);
total_bsadf[,region]=bsadft;
}
data
nreg <- NCOL(data); #Number of regions
wmin <-37;  #Change it if necessary!
total_gsadf <- matrix(nrow=1, ncol=nreg);
unroot_data=function(x,lag){
if(lag==0){
x_embed=embed(x,2);
return(cbind(x_embed[,1],1,x_embed[,2]));
}else{
x_embed=embed(x,lag+2);
dx_embed=embed(diff(x),lag+1)[,-1];
x_lev=x_embed[,1]; # the level of the series
x_lag=x_embed[,2]; # the lag of the series
dat=cbind(x_lev,1,x_lag,dx_embed);
return(dat);
}
}
rls.phillipsgsadf <- function(yxmat,wmin){
# wmin - minimum window size
# yxmat[,1] dependent variables
# yxmat[,-1]  covariates - including the intercept in the first column
ny <- NROW(yxmat); #Sample size
w <- wmin;
nr <-  ny-w+1;
x <- as.matrix(yxmat[,-1]);
y <- as.matrix(yxmat[,1]);
numcol <- NCOL(x);
####Create matrices to store SADF, BSADF####
tstat <- matrix(data=-99,nrow=ny,ncol=nr);
sadf <- matrix(,nrow=nr,ncol=1);
bsadf <- matrix(,nrow=nr, ncol=ny);
bsadft <- matrix(,nrow=ny, ncol=1);
####Run the Loop####
for(i in 1:nr){
w <- wmin;
sxx <- x[i:(w+i-1),];
sym <- y[i:(w+i-1),];
sy <- as.matrix(sym);
sx <-as.matrix(sxx);
tsx <- t(sx);
g <- qr.solve(tsx%*%sx);
b <- as.matrix(g%*%tsx%*%sy);
res <- sy-sx%*%b;
sqres <- sum(res^2) ;
vares <- sqres/(w-numcol);
sbb <- sqrt(vares*diag(g));
sb <- as.matrix(sbb);
tstat[w+i-1,i] <- (b[2,1]-1)/sb[2,1];
w <- w+1;
while((w+i-1)<(ny+1)) {
sxx <- x[i:(w+i-1),];
sym <- y[i:(w+i-1),];
sy <- as.matrix(sym);
sx <-as.matrix(sxx);
tsxn <- as.matrix(x[w+i-1,]);
syn <- as.matrix(y[w+i-1,]);
sxn <- t(tsxn);
kaka<-  as.vector( (1+sxn%*%g%*%tsxn)^(-1) , "numeric");
g <- g - kaka*(g%*%tsxn)%*%(sxn%*%g);
b <- b-g%*%tsxn%*%(sxn%*%b-syn);
res <- sy-sx%*%b;
sqres <- sum(res^2) ;
vares <- sqres/(w-numcol);
sbb <- sqrt(vares*diag(g));
sb <- as.matrix(sbb);
tstat[w+i-1,i] <- (b[2,1]-1)/sb[2,1];
w <- w+1;
}
sadf[i,1] <- max(tstat[,i]);
auxvec <- t(tstat[,i]);
bsadf[i,] <- auxvec;
}
gsadf<-max(sadf);
for(p in 1:ny){
bsadft[p,1] <- max(bsadf[,p]);
}
return(bsadft);
}
rls.phillipsgsadf(data,7)
0.1 + 1.8/sqrt(295)
rls.phillipsgsadf(data,0.20)
rls.phillipsgsadf(data,20)
total_bsadf <- matrix(nrow=ny,ncol=nreg);
for(region in 1:nreg){
y=data[,region];
yxmat= unroot_data(y,0); #Change the number of lags if necessary
ny=NROW(yxmat);
bsadf=rls.phillipsgsadf(yxmat,wmin);
bsadft=as.matrix(bsadf);
total_bsadf[,region]=bsadft;
}
total_gsadf <- matrix(nrow=1, ncol=nreg);
total_gsadf
unroot_data(P_final,3)
matr <- unroot_data(P_final,3)
rls.phillipsgsadf(matr,20)
total_bsadf <- matrix(nrow=ny,ncol=nreg);
for(region in 1:nreg){
y=data[,region];
yxmat= unroot_data(y,0); #Change the number of lags if necessary
ny=NROW(yxmat);
bsadf=rls.phillipsgsadf(yxmat,wmin);
bsadft=as.matrix(bsadf);
total_bsadf[,region]=bsadft;
}
0.19*296
matr <- unroot_data(P_final,4)
0.19*295
rls.phillipsgsadf(matr,56)
vector <- rls.phillipsgsadf(matr,56)
vector[vector >1.89]
vector >1.89
total_bsadf
total_bsadf <- matrix(nrow=ny,ncol=nreg);
for(region in 1:nreg){
y=data[,region];
yxmat= unroot_data(y,0); #Change the number of lags if necessary
ny=NROW(yxmat);
bsadf=rls.phillipsgsadf(yxmat,wmin);
bsadft=as.matrix(bsadf);
total_bsadf[,region]=bsadft;
}
for(region in 1:nreg){
y=data[,region];
yxmat= unroot_data(y,4); #Change the number of lags if necessary
ny=NROW(yxmat);
bsadf=rls.phillipsgsadf(yxmat,wmin);
bsadft=as.matrix(bsadf);
total_bsadf[,region]=bsadft;
}
300.18
300/18
5/4
0.3^2
1-0.09
1.09/0.91
1.3/0.91
0.3*0.91/1.3
0.3*0.91/1.3 - 0.3
0.09*0.91/1.3
0.09 - 0.09*0.91/1.3
-0.05*29 - 0.16*0 + 0.14*4 + 0.3
1/(1 + exp(0.59))
x <- c(1, 1/9, 1/4, 1, 1)
y <- c(-3, 2/3, 3/2, -4, 4)
y <- y/sqrt(x)
x1 <- 1/sqrt(x)
x2 <- x/sqrt(x)
model <- lm(y ~ x1 + x2 - 1)
model
ч
x
y
xx <- sqrt(x)
xx
y_star <- y/x
x_star <- x/xx
y_star <- y/xx
var(y_star)
cov(y_star,x_star)
cov(y_star,x_star)/var(y_star)
y_star <- y/x
x_star <- x/x
const_star <- 1/x
cov(y_star,x_star)/var(y_star)
cov(y_star,const_star)/var(y_star)
ls(y ~ x1 + x2)
lm(y ~ x1 + x2)
lm(y ~ x1 + x2-1)
x
y
x <- c(1, 1/9, 1/4, 1, 1)
y <- c(-3, 2/3, 3/2, -4, 4)
x
y
cov(1/x,y/x)/var(y/x)
0.2*2.7
0.2*2.7+0.1+2.5
0.64*0.2
0.4 + 0.2*0.7 + 0.1*0.5
0.2*0.5 + 0.6
0.2*0.7 + 0.1*0.5 + 0.4
0.2*0.59 + 0.1*0.7
0.2*0.188 + 0.1*0.59 + 0.1
0.2*0.1966 + 0.1*0.188
0.2*0.05812 + 0.1*0.1966
0.2*0.031284 + 0.1*0.05812
x <- c(1, 1/9, 1/4, 1, 1)
y <- c(-3, 2/3, 3/2, -4, 4)
500-220
280/42
42*43
280/1806
sqrt(280/1806)
41*43
280/1763
sqrt(280/1763)
1-0.89
0.89-0.6
0.29*97
0.29*97/0.11
sqrt(0.29*97/0.11)
3/sqrt(0.29*97/0.11)
0.5 + 0.7 + 0.59 + 0.188 + 0.1966 + 0.05812 + 0.031284 + 0.0120688
round(5/9,4)
0.2*0.2/(0.2*0.2 + 0.14*0.1)
round(0.2*0.2/(0.2*0.2 + 0.14*0.1),4)
10/17
sqrt(32,4)
32^(1/4)
2^(1/4)
2*2^(1/4)
16/sqrt(2)
library(readr)
rating <- read_csv("~/Downloads/rating.csv")
View(rating)
raiting
rating
rating$year
rating$year == 2017
rating[rating$year == 2017,]
colsum(rating[rating$year == 2017,])
colSums(rating[rating$year == 2017,])
rating
View(rating)
rating
rating[,31]
rating[,-31]
rating
rating[,31]
colSums(rating[rating$year == 2017,])
View(rating)
rating
rating = rating[,-31]
colSums(rating[rating$year == 2017,])
new_df = data.frame( )
rating$year
unique(rating$year)
new_df = data.frame( )
years = unique(rating$year)
for(yyy in years):
wow = colSums(rating[rating$year == yyy,])
for(yyy in years){
wow = colSums(rating[rating$year == yyy,])
new_df = append(new_df,wow)
}
head(new_df)
new_df = data.frame( )
years = unique(rating$year)
for(yyy in years){
wow = colSums(rating[rating$year == yyy,])
new_df$yyy = wow
}
head(new_df)
new_df = data.frame( )
years = unique(rating$year)
for(yyy in years){
wow = colSums(rating[rating$year == yyy,])
new_df = rbind(new_df, wow)
}
head(new_df)
View(new_df)
names(rating)
names(new_df) = names(rating)
new_df = data.frame( )
names(new_df) = names(rating)
new_df = data.frame( )
years = unique(rating$year)
for(yyy in years){
wow = colSums(rating[rating$year == yyy,])
new_df = rbind(new_df, wow)
}
names(new_df) = names(rating)
head(new_df)
View(new_df)
View(new_df)
24/5
shiny::runApp('Desktop/russia_motherland')
runApp('Desktop/russia_motherland')
runApp('Desktop/russia_motherland')
library(rsconnect)
deployApp()
pwd
deployApp("/home/filipp/Desktop/russia_motherland2")
file.copy('www/foo.pdf', alldata)
alldata <- read.csv('data/Prod_price_03_16_m.csv',sep=',',header=TRUE)
setwd("~/Desktop/russia_motherland2")
alldata <- read.csv('data/Prod_price_03_16_m.csv',sep=',',header=TRUE)
file.copy('www/foo.pdf', alldata)
file.copy('www/foo.pdf', file)
runApp()
runApp()
runApp()
runApp()
setwd("~/Desktop/russia_motherland2")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
p <- ggplot() +
geom_polygon(data = map.df, mapping = aes(x=long, y=lat, group = group, fill = DATA),
colour= 'grey',size = 0.01 )+
scale_fill_gradientn(colours = palette(100), na.value='grey80', name = 'рублей')+
coord_fixed(2.2) +
theme(axis.line=element_blank(),
axis.text.x=element_blank(),
axis.text.y=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
legend.position = 'right',
legend.text = element_text(colour = 'grey50',size = 7),
legend.title = element_text(colour = 'grey50',size = 12),
panel.spacing = unit(c(0,0,0,0), 'cm'),
axis.ticks.length = unit(0.001, 'cm'),
plot.margin = unit(c(-1,0,0,-0.8), 'cm'),
panel.grid = element_blank(),
panel.background = element_blank()
) +
labs(x=NULL, y = NULL)
runApp()
p <- ggplot() +
geom_polygon(data = map.df, mapping = aes(x=long, y=lat, group = group, fill = DATA),
colour= 'grey',size = 0.01 )+
scale_fill_gradientn(colours = palette(100), na.value='grey80', name = 'рублей')+
coord_fixed(2.2) +
theme(axis.line=element_blank(),
axis.text.x=element_blank(),
axis.text.y=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
legend.position = 'right',
legend.text = element_text(colour = 'grey50',size = 10),
legend.title = element_text(colour = 'grey50',size = 14),
panel.spacing = unit(c(0,0,0,0), 'cm'),
axis.ticks.length = unit(0.001, 'cm'),
plot.margin = unit(c(-1,0,0,-0.8), 'cm'),
panel.grid = element_blank(),
panel.background = element_blank()
) +
labs(x=NULL, y = NULL)
runApp()
shiny::runApp()
